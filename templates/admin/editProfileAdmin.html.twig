{% extends 'base-back.html.twig' %}


  {% block body %}
 <head>
        
        <meta charset="utf-8" />
        <title>Customers | Minible - Admin & Dashboard Template</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta content="Premium Multipurpose Admin & Dashboard Template" name="description" />
        <meta content="Themesdesign" name="author" />
        <!-- App favicon -->
        <link rel="shortcut icon" href="{{asset('back-office/images/favicon.ico')}}">

        <!-- DataTables -->
        <link href="{{asset('back-office/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css')}}" rel="stylesheet" type="text/css" />

        <!-- Responsive datatable examples -->
        <link href="{{asset('back-office/libs/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css')}}" rel="stylesheet" type="text/css" />  

        <!-- Bootstrap Css -->
        <link href="{{asset('back-office/css/bootstrap.min.css')}}" id="bootstrap-style" rel="stylesheet" type="text/css" />
        <!-- Icons Css -->
        <link href="{{asset('back-office/css/icons.min.css')}}" rel="stylesheet" type="text/css" />
        <!-- App Css-->
        <link href="{{asset('back-office/css/app.min.css')}}" id="app-style" rel="stylesheet" type="text/css" />

        <!-- real time validation -->
        <script src="{{asset('validationJs/formValidation.js')}}"></script>

        <!-- Sweet Alert css -->
        <link href="{{asset('back-office/libs/sweetalert2/sweetalert2.min.css')}}" rel="stylesheet" type="text/css" />
        <!-- Sweet Alerts js -->
        <script src="{{asset('back-office/libs/sweetalert2/sweetalert2.min.js')}}"></script>
        <!-- Sweet alert init js-->
        <script src="{{asset('back-office/js/pages/sweet-alerts.init.js')}}"></script>
        <script src="{{asset('validationJs/twoFactor.js')}}"></script>

    </head>
<body>
 <div class="row">

        <div class="col-xl-6">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title">Modifier votre Profile</h4>
                                        {# <p class="card-title-desc">Provide valuable, actionable feedback to your users with HTML5 form validationâ€“available in all our supported browsers.</p> #}
                                        <form  method="post" class="needs-validation" novalidate enctype="multipart/form-data" id="editUserForm">
                                        <div class="row">
                                              <div class="col-md-6">
                                                  <div class="text-end">
                                                        <img src="{{ asset('uploads/users/' ~admin.image) }}" alt="" class="avatar-lg rounded-circle img-thumbnail">
                                                  </div>  
                                                </div>
                                                <div class="col-md-6">

                                                  <label for="image">Choose Image:</label>
                                                  <input type="file" id="image" name="image">
                                                </div>
                                        </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="nom">Nom Complet</label>
                                                        <input type="text" class="form-control" id="name" name="nom"  placeholder="First name" value="{{ admin.nom }}" oninput="isValidName()" required>
                                                        <span id="error_name" class="text-danger" style="color: red;"></span>
                                                        <span id="success_name" class="text-success" style="color: green;"></span>
                                                        
                                                        <div class="valid-feedback">
                                                            Looks good!
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="email">email</label>
                                                        <input type="text" class="form-control" id="email" name="email" placeholder="email" value="{{ admin.email }}" oninput="isValidEmail()" required>
                                                        <span id="error_email" class="text-danger" style="color: red;"></span>
                                                        <span id="success_email" class="text-success" style="color: green;"></span>

                                                        <div class="valid-feedback">
                                                            Looks good!
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="telephone">Telephone</label>
                                                        <input type="text" class="form-control" name="telephone" id="telephone" placeholder="Telephone" value="{{ admin.telephone }}" oninput="isValidPhoneNumber()" required>
                                                        <span id="error_Telephone" class="text-danger" style="color: red;"></span>
                                                        <span id="success_Telephone" class="text-success" style="color: green;"></span>
                                                     
                                                        <div class="invalid-feedback">
                                                            Please provide a valid city.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            {# <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="mb-3">
                                                        <input type="image" class="form-control" name="image" id="image" placeholder="image" value="{{ coach.image }}" required>
                                                            <div class="invalid-feedback">
                                                                You must agree before submitting.
                                                            </div>
                                                    </div>
                                                </div>
                                            </div> #}
                                            <button class="btn btn-primary" type="submit">Modifier</button>
                                            <a href="{{ path('admin_profile') }}" class="btn btn-secondary waves-effect">
                                                        Annuler
                                                    </a>
                                        </form>
                                    </div>
                                </div>
                                <!-- end card -->
            </div> <!-- end col -->
        <div class="col-xl-6">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title">Changer le mot de passe </h4>
                                        <p class="card-title-desc">Merci de saisir votre mot de passe actuel pour changer le mot de passe</p>
                                    <form class="needs-validation" novalidate method="post" action="{{ path('admin_edit_pwd') }}"  id="editPasswordForm">
                                         {% if mdp is same as(false) %}
                                         <div class="row">
                                                <div class="col-md-5">
                                                    <div class="mb-3 position-relative">
                                                        <label class="form-label" for="userpassword">mot de passe actuel</label>
                                                        <input type="password" class="form-control" id="userpassword" placeholder="Entrez le mot de passe actuel" name="actualPassword" required>
                                                        {% if erreur is same as(true) %}
                                                        <p style="color:red;">mot de passe incorrect</p>
                                                        {% endif %}
                                                        <div class="valid-tooltip">
                                                            Looks good!
                                                        </div>
                                                    
                                                </div>
                                                {% endif %}
                                                {# Remove the unnecessary if statement #}
                                                {% if mdp is same as(true) %}
                                                    {# <div class="alert alert-danger" role="alert">
                                                        <strong>Erreur!</strong> Mot de passe incorrect
                                                    </div> #}
                                                
                                            <div class="row">
                                                <div class="col-md-5">
                                                    <div class="mb-3 position-relative">
                                                        <label class="form-label" for="userpassword">Nouveau mot de passe </label>
                                                        <input type="password" class="form-control" id="userpassword" placeholder="Entrez le nouveau mot de passe" name="plainPassword" oninput="isValidPassword()" required>
                                                        <span id="error_userpassword" class="text-danger" style="color: red;"></span>
                                                        <span id="success_userpassword" class="text-success" style="color: green;"></span>
                                                        <div class="valid-tooltip">
                                                            Looks good!
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-5">
                                                    <div class="mb-3 position-relative">
                                                        <label class="form-label" for="userpassword">RÃ©pÃ©ter le mot de passe</label>
                                                        <input type="password" class="form-control" id="userpasswordConfirm" placeholder="RÃ©pÃ©ter le mot de passe" name="plainPasswordConfirm" oninput="isValidPasswordConfirm()" required>
                                                        <span id="error_userpasswordConfirm" class="text-danger" style="color: red;"></span>
                                                        <span id="success_userpasswordConfirm" class="text-success" style="color: green;"></span>
                                                        <div class="valid-tooltip">
                                                            Looks good!
                                                        </div>
                                                    </div>
                                                </div>
                                            
                                            </div>
                                            {% endif %}
                                            <button class="btn btn-primary" type="submit">RÃ©initialiser</button>
                                        </form>
                                    </div>
                                </div>
                                <!-- end card -->
                            </div> <!-- end col -->
                        </div>
  
  
  </div>
  <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">Enable multi-factor authentication</h4>                              
                    <p class="card-title    -desc">Enable multi-factor authentication to add an extra layer of security to your account.</p>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <input class="form-check-input" type="checkbox" id="showQRCode" onclick="showQrCode()">
                                <label class="form-check form-check-label" for="showQRCode">Enable 2FA</label>
                                
                            </div>
                            <div class="mb-3" id="qrCodeField" style="display: none;"  >
                                <label class="form-label" for="qrCode">QR Code</label>
                                <img id="qrCode" src="{{qrCode}}" alt="Your QR Code will be displayed here.">
                                <form action="{{ path('activte_2fa') }}" method="post">
                                    <input type="hidden" name="secretKey" value="{{ secret }}">
                                    <label for="otp">Code OTP:</label>
                                    <input type="text" id="otp" name="otp">
                                    <button type="submit">Activer 2FA</button>
                                </form>
                            </div>

                        </div>
    
                    </div>
                          <button class="btn btn-primary" type="submit">Enable</button>
                </div>
            </div>
             
              {# -////////////////////////////////////////////////////////////////////////////// #}
              
            <div class="col-12 col-sm-6 col-lg-4 mb-4">
                <div class="card">
                <div class="card-body text-center">
                    <i class="mb-3 fas fa-lock"></i>
                    <h5>Two Factor Auth</h5>
                    <p>Enhance your application security by enabling two factor authentication.</p>
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#twoFactorAuthOne"> Show </button>
                </div>
                </div>
            </div>

           <!-- Two Factor Auth Modal -->

            {# <div class="modal fade" id="twoFactorAuth" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered modal-simple">
                <div class="modal-content p-3 p-md-5">
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-4">
                    <h3 class="mb-2">Select Authentication Method</h3>
                    <p class="text-muted">You also need to select a method by which the proxy authenticates to the directory serve.</p>
                    </div>
                    <div class="row">
                    <div class="col-12 mb-3">
                        <div class="form-check custom-option custom-option-basic">
                        <label class="form-check-label custom-option-content ps-3" for="customRadioTemp1" data-bs-target="#twoFactorAuthOne" data-bs-toggle="modal">
                            <input name="customRadioTemp" class="form-check-input d-none" type="radio" value="" id="customRadioTemp1" />
                            <span class="d-flex align-items-start">
                            <i class="bx bx-cog bx-md me-3"></i>
                            <span>
                                <span class="custom-option-header">
                                <span class="h4 mb-2">Authenticator Apps</span>
                                </span>
                                <span class="custom-option-body">
                                <span class="mb-0">Get code from an app like Google Authenticator or Microsoft Authenticator.</span>
                                </span>
                            </span>
                            </span>
                        </label>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-check custom-option custom-option-basic">
                        <label class="form-check-label custom-option-content ps-3" for="customRadioTemp2" data-bs-target="#twoFactorAuthTwo" data-bs-toggle="modal">
                            <input name="customRadioTemp" class="form-check-input d-none" type="radio" value="" id="customRadioTemp2" />
                            <span class="d-flex align-items-start">
                            <i class="bx bx-message bx-md me-3"></i>
                            <span>
                                <span class="custom-option-header">
                                <span class="h4 mb-2">SMS</span>
                                </span>
                                <span class="custom-option-body">
                                <span class="mb-0">We will send a code via SMS if you need to use your backup login method.</span>
                                </span>
                            </span>
                            </span>
                        </label>
                        </div>
                    </div>
                    </div>
                </div>
                </div>
            </div>
            </div> #}
            <!-- Modal Authentication App -->
            <div class="modal fade" id="twoFactorAuthOne" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered modal-simple">
                <div class="modal-content p-3 p-md-5">
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-2">
                        <h3 class="mb-0">Add Authenticator App</h3>
                    </div>
                    <h5 class="mb-2 pt-1 text-break">Authenticator Apps</h5>
                    <p class="mb-4">Using an authenticator app like Google Authenticator, Microsoft Authenticator, Authy, or 1Password, scan the QR code. It will generate a 6-digit code for you to enter below.</p>
                    <div class="text-center">
                        {# <img src="../../assets/img/icons/misc/authentication-QR.png" alt="QR Code" width="140"> #}
                        <img id="qrCode" src="{{qrCode}}" alt="Your QR Code will be displayed here." width="140" style="padding-bottom: 10px;">
                    </div>
                    {# <div class="alert alert-warning alert-dismissible my-3" role="alert">
                        <h5 class="alert-heading mb-2 text-break">ASDLKNASDA9AHS678dGhASD78AB</h5>
                        <p class="mb-0">If you're having trouble using the QR code, select manual entry on your app</p>
                    </div> #}
                     <form action="{{ path('activte_2fa') }}" method="post">
                    <div class="mb-4">
                        <input type="email" class="form-control" id="twoFactorAuthInput" placeholder="Enter Authentication Code">
                    </div>
                    <div class="col-12 text-end">
                        <button type="button" class="btn btn-label-secondary me-sm-3 me-2 px-3 px-sm-4" data-bs-toggle="modal" data-bs-target="#twoFactorAuth"><i class="dripicons-chevron-left bx-xs me-1 scaleX-n1-rtl"></i><span class="align-middle">Back</span></button>
                        <button type="submit" class="btn btn-primary px-3 px-sm-4" data-bs-dismiss="modal" aria-label="Close"><span class="align-middle">Continue</span><i class="dripicons-chevron-right bx-xs ms-1 scaleX-n1-rtl"></i></button>
                    </div>
                    </form>
                    {# //////////////////////////////////////////// #}
                        <form action="{{ path('activte_2fa') }}" method="post">
                            <input type="hidden" name="secretKey" value="{{ secret }}">
                            <label for="otp">Code OTP:</label>
                            <input type="text" id="otp" name="otp">
                            <button type="submit">Activer 2FA</button>
                        </form>

                    {# //////////////////////////////////////////// #}

                </div>
                </div>
            </div>
            </div>
            <script>
            // Check selected custom option
            window.Helpers.initCustomOptionCheck();

            </script>

        </div>
    </div>
  </body>
{% endblock %}  